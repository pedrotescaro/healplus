<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heal+ - Captura e An√°lise de Feridas</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/wound-capture.css">
    <link rel="stylesheet" href="css/animations.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo">
                    <h1>üè• Heal+</h1>
                    <span>Captura Inteligente de Feridas</span>
                </div>
                <nav class="header-nav">
                    <a href="index.html" class="nav-link">Dashboard</a>
                    <a href="clinician.html" class="nav-link">Portal Cl√≠nico</a>
                    <a href="telehealth.html" class="nav-link">Telessa√∫de</a>
                </nav>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="wound-capture-container">
                <!-- Progress Steps -->
                <div class="progress-steps">
                    <div class="step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-label">Prepara√ß√£o</div>
                    </div>
                    <div class="step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-label">Captura</div>
                    </div>
                    <div class="step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-label">An√°lise IA</div>
                    </div>
                    <div class="step" data-step="4">
                        <div class="step-number">4</div>
                        <div class="step-label">Resultados</div>
                    </div>
                </div>

                <!-- Step 1: Preparation -->
                <div class="capture-step active" id="step-1">
                    <div class="step-content">
                        <h2>üìã Prepara√ß√£o para Captura</h2>
                        <div class="preparation-guide">
                            <div class="guide-section">
                                <h3>üéØ Posicionamento</h3>
                                <ul>
                                    <li>Mantenha o dispositivo a 15-20cm da ferida</li>
                                    <li>Use a r√©gua de refer√™ncia para calibra√ß√£o</li>
                                    <li>Certifique-se de que a ferida est√° bem iluminada</li>
                                    <li>Evite sombras ou reflexos</li>
                                </ul>
                            </div>
                            <div class="guide-section">
                                <h3>üìè Calibra√ß√£o</h3>
                                <div class="calibration-tools">
                                    <div class="reference-ruler">
                                        <div class="ruler-markings">
                                            <div class="marking" data-cm="1">1cm</div>
                                            <div class="marking" data-cm="2">2cm</div>
                                            <div class="marking" data-cm="3">3cm</div>
                                            <div class="marking" data-cm="4">4cm</div>
                                            <div class="marking" data-cm="5">5cm</div>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary" onclick="startCalibration()">
                                        Iniciar Calibra√ß√£o
                                    </button>
                                </div>
                            </div>
                            <div class="guide-section">
                                <h3>üì± Configura√ß√µes da C√¢mera</h3>
                                <div class="camera-settings">
                                    <label>
                                        <input type="checkbox" id="flash-enabled" checked>
                                        Flash autom√°tico
                                    </label>
                                    <label>
                                        <input type="checkbox" id="stabilization-enabled" checked>
                                        Estabiliza√ß√£o de imagem
                                    </label>
                                    <label>
                                        <input type="checkbox" id="hdr-enabled">
                                        HDR (alta defini√ß√£o)
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="step-actions">
                            <button class="btn btn-primary" onclick="nextStep()">
                                Pr√≥ximo: Captura
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Capture -->
                <div class="capture-step" id="step-2">
                    <div class="step-content">
                        <h2>üì∏ Captura da Ferida</h2>
                        <div class="capture-interface">
                            <div class="camera-container">
                                <video id="camera-preview" autoplay muted></video>
                                <canvas id="capture-canvas" style="display: none;"></canvas>
                                <div class="capture-overlay">
                                    <div class="focus-ring"></div>
                                    <div class="reference-grid"></div>
                                    <div class="distance-indicator">
                                        <span id="distance-text">15-20cm</span>
                                    </div>
                                </div>
                            </div>
                            <div class="capture-controls">
                                <button class="btn btn-secondary" onclick="switchCamera()">
                                    üîÑ Trocar C√¢mera
                                </button>
                                <button class="btn btn-primary capture-btn" onclick="captureImage()">
                                    üì∏ Capturar
                                </button>
                                <button class="btn btn-secondary" onclick="previousStep()">
                                    ‚Üê Voltar
                                </button>
                            </div>
                        </div>
                        <div class="capture-tips">
                            <h3>üí° Dicas para Melhor Captura</h3>
                            <ul>
                                <li>Mantenha o dispositivo est√°vel</li>
                                <li>Certifique-se de que toda a ferida est√° vis√≠vel</li>
                                <li>Use a r√©gua de refer√™ncia para escala</li>
                                <li>Evite movimentos durante a captura</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Step 3: AI Analysis -->
                <div class="capture-step" id="step-3">
                    <div class="step-content">
                        <h2>ü§ñ An√°lise por Intelig√™ncia Artificial</h2>
                        <div class="analysis-container">
                            <div class="analysis-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="analysis-progress"></div>
                                </div>
                                <div class="progress-text" id="analysis-text">Iniciando an√°lise...</div>
                            </div>
                            <div class="analysis-steps">
                                <div class="analysis-step active" id="step-segmentation">
                                    <div class="step-icon">üéØ</div>
                                    <div class="step-info">
                                        <h4>Segmenta√ß√£o da Ferida</h4>
                                        <p>Identificando contornos e √°rea da ferida</p>
                                    </div>
                                </div>
                                <div class="analysis-step" id="step-tissue">
                                    <div class="step-icon">üî¨</div>
                                    <div class="step-info">
                                        <h4>Classifica√ß√£o de Tecidos</h4>
                                        <p>Analisando tipos de tecido (granula√ß√£o, esfacelo, necrose)</p>
                                    </div>
                                </div>
                                <div class="analysis-step" id="step-measurement">
                                    <div class="step-icon">üìè</div>
                                    <div class="step-info">
                                        <h4>Medi√ß√µes Autom√°ticas</h4>
                                        <p>Calculando √°rea, per√≠metro e dimens√µes</p>
                                    </div>
                                </div>
                                <div class="analysis-step" id="step-risk">
                                    <div class="step-icon">‚ö†Ô∏è</div>
                                    <div class="step-info">
                                        <h4>Avalia√ß√£o de Risco</h4>
                                        <p>Determinando risco de infec√ß√£o e complica√ß√µes</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Results -->
                <div class="capture-step" id="step-4">
                    <div class="step-content">
                        <h2>üìä Resultados da An√°lise</h2>
                        <div class="results-container">
                            <div class="results-grid">
                                <!-- Wound Image with Overlay -->
                                <div class="result-card image-card">
                                    <h3>üñºÔ∏è Imagem Analisada</h3>
                                    <div class="wound-image-container">
                                        <img id="analyzed-image" src="" alt="Ferida analisada">
                                        <canvas id="overlay-canvas"></canvas>
                                    </div>
                                    <div class="image-controls">
                                        <button class="btn btn-sm" onclick="toggleOverlay('segmentation')">
                                            Contorno
                                        </button>
                                        <button class="btn btn-sm" onclick="toggleOverlay('tissue')">
                                            Tecidos
                                        </button>
                                        <button class="btn btn-sm" onclick="toggleOverlay('measurements')">
                                            Medi√ß√µes
                                        </button>
                                    </div>
                                </div>

                                <!-- Measurements -->
                                <div class="result-card measurements-card">
                                    <h3>üìè Medi√ß√µes</h3>
                                    <div class="measurements-grid">
                                        <div class="measurement-item">
                                            <div class="measurement-label">√Årea</div>
                                            <div class="measurement-value" id="area-value">-- cm¬≤</div>
                                        </div>
                                        <div class="measurement-item">
                                            <div class="measurement-label">Per√≠metro</div>
                                            <div class="measurement-value" id="perimeter-value">-- cm</div>
                                        </div>
                                        <div class="measurement-item">
                                            <div class="measurement-label">Largura</div>
                                            <div class="measurement-value" id="width-value">-- cm</div>
                                        </div>
                                        <div class="measurement-item">
                                            <div class="measurement-label">Comprimento</div>
                                            <div class="measurement-value" id="length-value">-- cm</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Tissue Analysis -->
                                <div class="result-card tissue-card">
                                    <h3>üî¨ An√°lise de Tecidos</h3>
                                    <div class="tissue-analysis">
                                        <div class="tissue-item">
                                            <div class="tissue-color granulation"></div>
                                            <div class="tissue-info">
                                                <div class="tissue-name">Granula√ß√£o</div>
                                                <div class="tissue-percentage" id="granulation-percent">--%</div>
                                            </div>
                                        </div>
                                        <div class="tissue-item">
                                            <div class="tissue-color slough"></div>
                                            <div class="tissue-info">
                                                <div class="tissue-name">Esfacelo</div>
                                                <div class="tissue-percentage" id="slough-percent">--%</div>
                                            </div>
                                        </div>
                                        <div class="tissue-item">
                                            <div class="tissue-color necrosis"></div>
                                            <div class="tissue-info">
                                                <div class="tissue-name">Necrose</div>
                                                <div class="tissue-percentage" id="necrosis-percent">--%</div>
                                            </div>
                                        </div>
                                        <div class="tissue-item">
                                            <div class="tissue-color epithelial"></div>
                                            <div class="tissue-info">
                                                <div class="tissue-name">Epitelial</div>
                                                <div class="tissue-percentage" id="epithelial-percent">--%</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Risk Assessment -->
                                <div class="result-card risk-card">
                                    <h3>‚ö†Ô∏è Avalia√ß√£o de Risco</h3>
                                    <div class="risk-assessment">
                                        <div class="risk-item">
                                            <div class="risk-label">Risco de Infec√ß√£o</div>
                                            <div class="risk-level" id="infection-risk">--</div>
                                        </div>
                                        <div class="risk-item">
                                            <div class="risk-label">Progresso da Cicatriza√ß√£o</div>
                                            <div class="risk-level" id="healing-progress">--</div>
                                        </div>
                                        <div class="risk-item">
                                            <div class="risk-label">Recomenda√ß√£o</div>
                                            <div class="risk-recommendation" id="recommendation">--</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Actions -->
                            <div class="results-actions">
                                <button class="btn btn-secondary" onclick="retakePhoto()">
                                    üì∏ Nova Captura
                                </button>
                                <button class="btn btn-primary" onclick="saveResults()">
                                    üíæ Salvar An√°lise
                                </button>
                                <button class="btn btn-success" onclick="scheduleFollowUp()">
                                    üìÖ Agendar Acompanhamento
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/wound-capture.js"></script>
    <script src="js/ai-analysis.js"></script>
</body>
</html>
